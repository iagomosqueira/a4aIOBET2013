% Investigating the stock status of Indian Ocean Bigeye tuna using the a4a statistical catch-at-age assessment method.
% Iago Mosqueira$^\dagger$[^contact]; Colin P. Millar[^aff]
% October 2013


[^aff]: European Commission, Joint Research Center, IPSC/Maritime Affairs Unit, FISHREG, Via E. Fermi 2749, 21027 Ispra VA, Italy
[^contact]: Contact Author: iago.mosqueira-sanchez@jrc.ec.europa.eu

```{r, setup, echo=FALSE, results='hide', message=FALSE, cache=FALSE, warnings=FALSE}
library(knitr)
opts_chunk$set(dev='pdf', fig.width=4, fig.height=4, warnings=FALSE, cache=TRUE, echo=FALSE)
options(width=50)
```

```{r, pkgs, echo=FALSE, results='hide', message=FALSE, warnings=FALSE}
library(FLa4a)
library(ggplotFL)
library(pander)
theme_set(theme_bw())
set.seed(1423)
```

# Introduction

A recently developed statistical catch-at-age stock assessment method, a4a, designed for evaluating the status of stocks with intermediate data quality, is applied here to Indian Ocean bigeye tuna. The method provides huge flexibility for the rapid evaluation of the effects in parameter estimates and uncertainty of different submodels for fishing mortality-at-age (the F model), CPUE catchability-at-age (the Q model), stock recruitment (the R model) and observation variance (the V model).

The model does not attempt to substitute more complex stock assessments that make use of all sources of data, including tagging, but to provide a tool for rapid exploration of the influence of different assumptions and data sources. This capability is achieved by combining a powerful optimization engine (ADMB) with an intuitive user interface using linear models as expressed in the R language. The model is implemented as part of the FLR framework [@Kell2007], and thus can make use of the available tools for estimation of reference points, projections under different scenarios, plotting and diagnostics.

# The a4a stock assessment model


# Data

```{r, data, echo=FALSE, results='hide', message=FALSE}
load('data/bet_iotc_2011.RData')
```

The a4a stock assessment model is an age-based model, and requires a matrix of catch-at-age information that includes all fleets and areas, on a yearly time step. This is then combined with an abundance index, in this case an standardized total catch-per-unit-effort series for the Japanese longline fleet [@IOTC-2013-WPTT15-25].

## Catch-at-age

The catch-at-age dataset made available by the IOTC Secretariat \footnote{\url{http://iotc.org/files/proceedings/2013/wptt/BET_ASPMv2.zip}, 27/09/2013} was used.

```{r, nc, echo=FALSE, tidy=TRUE, fig.cap="Total catch series for Indian Ocean bigeye, 1950-2012.", fig.width=6, fig.height=3}
ggplot(data=catch(bet)/1000, aes(year, data)) + geom_point() + geom_line() + ylab("Catch (Kt)") + xlab("")
```


## CPUE index

# Model structure and assumptions

## Fixed parameters
```{r, fixed1, results='asis'}
pandoc.table(data.frame(Parameter=c('M',NA), Ages=c('0-1', '2-9'), Value=c(0.8, 0.4)), alignment='center')
```

```{r, waa, echo=FALSE, tidy=TRUE, fig.cap="Weight-at-age in catch and stock"}
ggplot(data=catch.wt(bet)[,1], aes(age, data)) + geom_line() + ylab("Weight (kg)") + xlab("age")
```

## Estimated parameters

# Model runs

## Simulation of catchability fitting

# Results

## Population trajectories

## Reference points

## Residual diagnostics

# Discussion

# Appendix I: a4a model population dynamics

# Appendix II: Code of final run

# References

